<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="James Hickey" />

<meta name="date" content="2024-01-21" />

<title>Getting started with the gbm package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting started with the gbm package</h1>
<h4 class="author">James Hickey</h4>
<h4 class="date">2024-01-21</h4>



<p>The <code>gbm</code> package implements gradient tree boosting for a
wide variety of statistical models and loss functions; including those
commonly used in statistics, such as the Cox model, but not usually
associated with boosted models. When presented with data, the
<code>gbm</code> package offers the user the ability to build predictive
models and explore the influence of different variables on the response,
akin to a data mining or exploration task.</p>
<p>To get started a user must:</p>
<ul>
<li>have a dataset in a <code>data.frame</code>.</li>
<li>select and make an appropriate distribution object.</li>
<li>set the training parameters for the gbm model.</li>
<li>set any additional variable and fitting parameters.</li>
</ul>
<p>Once these steps have been completed, a user can fit their
<code>gbm</code> model by a call to <code>gbmt</code> and subsequently:
evaluate its performance, make predictions, fit additional trees and
plot the relative influence of the various predictor variables</p>
<div id="example-dataset" class="section level3">
<h3>Example dataset</h3>
<p>To begin, this vignette will work with simulated data where the
response obeys a <code>Bernoulli</code> distribution and is determined
by 3 predictor variables. Every row of the data corresponds to an
individual observation and to these observations random weights are
assigned. These weights determine the importance of the associated
observation in the fit. At this stage it is also assumed that the fit
will be made directly to the response and <strong>no offset</strong> is
supplied. If the offset vector for each observation was non-zero the
<code>gbm</code> fit would be to the
<code>observation response + offset</code> rather than the bare
response. Currently the package supports responses which either consist
of: numerics, factors (i. e. <code>Bernoulli</code>) or are a survival
object (more specifically a counting or right centered survival object)
in the case of Cox proportional hazards models. <strong>NB:</strong>
Predictor variables may have missing data (specified by <code>NA</code>)
but the responses must have no missing observations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># create some binomial response data - N observations </span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],N,<span class="at">replace=</span>T))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)[<span class="fu">as.numeric</span>(X3)]</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="fu">sin</span>(<span class="dv">3</span><span class="sc">*</span>X1) <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>X2 <span class="sc">+</span> mu)))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,p) <span class="co"># response</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co"># Normalized weights for each observation</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>w <span class="ot">&lt;-</span> N<span class="sc">*</span>w<span class="sc">/</span><span class="fu">sum</span>(w)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co"># Offset is set to 0</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>offset <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co"># Collate data</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y=</span>Y,<span class="at">X1=</span>X1,<span class="at">X2=</span>X2,<span class="at">X3=</span>X3)</span></code></pre></div>
</div>
<div id="creating-a-gbm-distribution-object" class="section level2">
<h2>Creating a gbm distribution object</h2>
<p>The <code>gbm</code> package has a number of distributions available
to user. To view what distributions are currently available simply call
<code>available_distributions()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">available_distributions</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;AdaBoost&quot;  &quot;Bernoulli&quot; &quot;CoxPH&quot;     &quot;Gamma&quot;     &quot;Gaussian&quot;  &quot;Huberized&quot;
##  [7] &quot;Laplace&quot;   &quot;Pairwise&quot;  &quot;Poisson&quot;   &quot;Quantile&quot;  &quot;TDist&quot;     &quot;Tweedie&quot;</code></pre>
<p>From the list of available distributions a default
<code>GBMDist</code> object for each distribution can be created with
using the function <code>gbm_dist</code> and passing the desired
distribution’s name as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Create a default Bernoulli </span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>bern_dist <span class="ot">&lt;-</span> <span class="fu">gbm_dist</span>(<span class="st">&quot;Bernoulli&quot;</span>)</span></code></pre></div>
<p>Certain distributions have distribution specific parameters, such as
the number of degrees of freedom associated with the distribution. These
parameters are passed as arguments to <code>gbm_dist</code> and how this
is done is described in another vignette entitled
“model-specific-parameters”.</p>
</div>
<div id="setting-training-parameters" class="section level2">
<h2>Setting training parameters</h2>
<p>Once the data has been imported and the distribution object created,
the next task is to specify the training parameters for the
<code>gbm</code> package. These parameters are passed to
<code>gbmt</code> in the form of a <code>GBMTrainParams</code> object.
This S3 object can be created using the <code>training_params</code>
constructor and passing it the appropriate data to the fields. The named
parameters in the constructor are as follows:</p>
<ul>
<li><code>num_trees</code>: the number of iterations to use in the
fitting.</li>
<li><code>interaction_depth</code>: the max number of terminal nodes in
each tree - the larger this is the more likely overfitting is to occur -
depths of ~ 3-10 are usually recommended.</li>
<li><code>min_num_obs_in_node</code>: the minimum number of observations
that a node must have to be considered in fitting a tree. The default of
10 observations which is usually adequate but if your dataset is small
then this could be reduced.</li>
<li><code>shrinkage</code>: acts as regularization for additional
iterations - the smaller the shrinkage generally the better the
performance of the fit. However, smaller shrinkage implies that the
number of trees may need to be increased to achieve a certain
performance. In practice the default of <code>0.001</code> usually
suffices.</li>
<li><code>bag_fraction</code>: the fraction of the training observations
randomly sub-sampled to fit a tree in each iteration. This has the
effect of reducing the variance of the boosted model. The default
<code>bag_fraction=0.5</code> is recommended.</li>
<li><code>num_train</code>: the number of observations to be used in
training the model. This defaults to the minimum value such that the
terminal nodes of a fitted tree can be created.</li>
<li><code>id</code>: a sequence of integers specifying the id of each
observation in the data. This defaults to
<code>seq_len(num_train)</code>.</li>
<li><code>num_features</code>: the number of features randomly selected,
on each iteration, from the data when growing a tree.</li>
</ul>
<p>Once the parameters have been decided the appropriate object is
created. For further details on how these parameters and what they
represent, please view: <em>The Elements of Statistical Learning by
Friedman et al.</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Creating an appropriate training parameters object</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>train_params <span class="ot">&lt;-</span> <span class="fu">training_params</span>(<span class="at">num_trees =</span> <span class="dv">2000</span>, <span class="at">interaction_depth =</span> <span class="dv">3</span>, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                                <span class="at">num_train=</span><span class="fu">nrow</span>(data), <span class="at">num_features =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="additional-variable-and-fitting-parameters" class="section level2">
<h2>Additional variable and fitting parameters</h2>
<p>Before fitting our boosted model there are some other parameters to
consider. The monotonicity of each predictor variable with the outcome
variable can be specified with through the <code>var_monotone</code>
parameter. In this case the relationship is assumed to be arbitrary and
the parameter is unspecified. The names of the predictor variables may
also be specified via <code>var_names</code>.</p>
<div id="cross-validation" class="section level3">
<h3>Cross Validation</h3>
<p>Other parameters relating to cross-validation of the model may be
provided. Firstly, the number of folds to be used in cross-validation is
set by <code>cv_folds</code>, by default no cross-validation is done by
<code>gbmt</code>. An optional vector specifying what fold each
observation belongs to can also be specified through
<code>fold_id</code> and if the distribution selected is
<code>Bernoulli</code> the cross-validation can be stratified across the
response.</p>
</div>
<div id="parallelisation" class="section level3">
<h3>Parallelisation</h3>
<p>The core algorithm can be parallelized across numerous threads by
passing the output of <code>gbmParallel()</code> to the
<code>par_details</code> handle. In this example, more than one thread
for processing is not required and so the default is used.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Example of a gbmParallel with more threads</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>par_detail <span class="ot">&lt;-</span> <span class="fu">gbmParallel</span>(<span class="at">num_threads =</span> <span class="dv">10</span>) <span class="co"># Pass to par_details in gbmt</span></span></code></pre></div>
</div>
</div>
<div id="putting-it-all-together" class="section level2">
<h2>Putting it all together</h2>
<p>With the data defined, the distribution object created, the training
parameters and additional parameters specified, it is now time to fit
the model. This is done by passing these objects to <code>gbmt</code>
along with the model formula.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Create a gbm fit</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">gbmt</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3, <span class="at">distribution=</span>bern_dist, <span class="at">data=</span>data, <span class="at">weights =</span> w, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>            <span class="at">offset=</span>offset, <span class="at">train_params =</span> train_params,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>            <span class="at">cv_folds=</span><span class="dv">5</span>, <span class="at">keep_gbm_data=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>The <code>keep_gbm_data</code> flag indicates that the outputted
<code>GBMFit</code> object will contain the data passed to the fit
within a <code>GBMData</code> object.</p>
<div id="default-behaviour" class="section level3">
<h3>Default behaviour</h3>
<p>The process outlined above is slightly cumbersome. Thankfully,
<code>gbmt</code> has numerous default behaviours that are very useful.
Firstly, the distribution will be “guessed” if none is provided -
currently it can identify Bernoulli and Cox models, otherwise it
defaults to Gaussian. The “weights” parameter defaults to be uniform
across all the data rows and as the offset also defaults to 0 across all
data rows. The training parameters also specify 2000 trees, an
interaction depth of 3, identify one row per observation, use half the
available data in training and bag half the training data as well as use
all of the predictors in the fitting. Moreover, the weights are
normalized by the routine if the distribution is not “Pairwise”.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># A default fit to gaussian data</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">runif</span>(N)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],N,<span class="at">replace=</span>T))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">ordered</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],N,<span class="at">replace=</span>T))</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>X5 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],N,<span class="at">replace=</span>T))</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>X6 <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">runif</span>(N)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)[<span class="fu">as.numeric</span>(X3)]</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>SNR <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># signal-to-noise ratio</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X1<span class="sc">**</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (X2<span class="sc">**</span>.<span class="dv">5</span>) <span class="sc">+</span> mu</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(Y)<span class="sc">/</span>SNR)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y <span class="sc">+</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,sigma)</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co"># create a bunch of missing values</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>X1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N,<span class="at">size=</span><span class="dv">100</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>X3[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N,<span class="at">size=</span><span class="dv">300</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co"># Gaussian data</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>gauss_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y=</span>Y,<span class="at">X1=</span>X1,<span class="at">X2=</span>X2,<span class="at">X3=</span>X3,<span class="at">X4=</span>X4,<span class="at">X5=</span>X5,<span class="at">X6=</span>X6)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co"># Perform a cross-validated fit</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>gauss_fit <span class="ot">&lt;-</span> <span class="fu">gbmt</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5 <span class="sc">+</span> X6, </span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>                  <span class="at">data=</span>gauss_data, <span class="at">cv_folds =</span><span class="dv">5</span>, <span class="at">keep_gbm_data =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="identifying-the-optimal-iteration" class="section level2">
<h2>Identifying the optimal iteration</h2>
<p>A fitted model contains a number of measures of its performance.
Using these measures, the optimal iteration of a <code>gbm</code> fit
can be identified. The package offers three methods for identifying the
optimal iteration of the fit, these are: <code>&#39;test&#39;</code>,
<code>&#39;cv&#39;</code> and <code>&#39;OOB&#39;</code>. The <code>&#39;test&#39;</code> method
identifies the optimal iteration using the performance of the fit on a
set-aside independent test set, this is only available if the number of
observations used to fit the model is less than the number of
observations in the original data. The <code>&#39;cv&#39;</code> method
determines the best iteration number using the cross-validation error
provided and finally <code>&#39;OOB&#39;</code> selects the best iteration using
the out-of-bag error estimate. Again this is only available if
<code>bag_fraction &gt; 0</code> and it will under-estimate the optimal
number of iterations in the fit. The optimal iteration number as well as
a plot of the performance can then be obtained through a call to
<code>gbmt_performance</code>. In these performance plots the
cross-validation error, test set error and out-of-bag improvement are
represented by green, red and blue lines respectively. The error on the
training set is shown as a black line and the optimal iteration is
marked with a dashed blue line.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Use gaussian fit and determine the performance</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co"># red line is testing error</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># green line is cv error</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># blue line is OOB error</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>best_iter_test <span class="ot">&lt;-</span> <span class="fu">gbmt_performance</span>(gauss_fit, <span class="at">method=</span><span class="st">&#39;test&#39;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>best_iter_cv <span class="ot">&lt;-</span> <span class="fu">gbmt_performance</span>(gauss_fit, <span class="at">method=</span><span class="st">&#39;cv&#39;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>best_iter_oob <span class="ot">&lt;-</span> <span class="fu">gbmt_performance</span>(gauss_fit, <span class="at">method=</span><span class="st">&#39;OOB&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in best_iter_out_of_bag(gbm_fit_obj): OOB generally underestimates the
## optimal number of iterations although predictive performance is reasonably
## competitive. Using cv_folds&gt;1 when calling gbm usually results in improved
## predictive performance.</code></pre>
</div>
<div id="fitting-additional-trees" class="section level2">
<h2>Fitting additional trees</h2>
<p>After evaluating the performance it may be the case that the optimal
number of iterations is the <code>num_trees</code> parameter set. In
this instance additional trees may want to be fitted to the original
dataset; this will not alter the cross-validation fit but will update
the test set and OOB errors.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Fit additional trees to gaussian fit and recalculate optimal number of iterations</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>gauss_fit_more <span class="ot">&lt;-</span> <span class="fu">gbm_more</span>(gauss_fit, <span class="at">num_new_trees =</span> <span class="dv">5000</span>) <span class="co"># This is a large number of </span></span></code></pre></div>
<pre><code>## Warning in gbm_more(gauss_fit, num_new_trees = 5000): gbm_more is incompatible
## with cross-validation; losing cv results.</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>                                                            <span class="co">#extra trees!</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>best_iter_test_more <span class="ot">&lt;-</span> <span class="fu">gbmt_performance</span>(gauss_fit_more, <span class="at">method=</span><span class="st">&#39;test&#39;</span>)</span></code></pre></div>
</div>
<div id="predictions-on-other-data" class="section level2">
<h2>Predictions on other data</h2>
<p>With the model fitted and the optimal number of iterations
determined, the user can now make predictions on other datasets using
the <code>gbm</code> package’s <code>predict</code> functionality.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Given additional data - of the same shape as our gaussian example</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">runif</span>(N)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],N,<span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">ordered</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],N,<span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>X5 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],N,<span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>X6 <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">runif</span>(N)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)[<span class="fu">as.numeric</span>(X3)]</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X1<span class="sc">**</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (X2<span class="sc">**</span>.<span class="dv">5</span>) <span class="sc">+</span> mu</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y <span class="sc">+</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,sigma)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y=</span>Y,<span class="at">X1=</span>X1,<span class="at">X2=</span>X2,<span class="at">X3=</span>X3,<span class="at">X4=</span>X4,<span class="at">X5=</span>X5,<span class="at">X6=</span>X6)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co"># Then predictions can be made</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(gauss_fit_more, <span class="at">newdata=</span>data2, <span class="at">n.trees=</span>best_iter_test_more)</span></code></pre></div>
</div>
<div id="relative-influence-of-predictors" class="section level2">
<h2>Relative influence of predictors</h2>
<p><code>gbm</code> also offers a measure of the relative influence of
each predictor in the fitted model. The influence of a variable <span class="math inline">\(x_j\)</span> is determined by the sum across all
iterations of the improvements of a tree fit when split on that
variable.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Relative influence of predictors - both examples</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">relative_influence</span>(gauss_fit_more, best_iter_test_more))</span></code></pre></div>
<pre><code>##         X1         X2         X3         X4         X5         X6 
##  26365.267  91251.316 123736.475   4548.206   1395.813   9628.245</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">relative_influence</span>(fit, <span class="fu">gbmt_performance</span>(fit, <span class="at">method=</span><span class="st">&#39;cv&#39;</span>)))</span></code></pre></div>
<pre><code>##        X1        X2        X3 
##  1836.329 13560.888 11647.626</code></pre>
</div>
<div id="plotting-the-marginal-effects-of-selected-variables" class="section level2">
<h2>Plotting the marginal effects of selected variables</h2>
<p>As well as calculating the relative influence from the fitted trees,
<code>gbm</code> also offers the ability to calculate the predictions of
specific variables and make the appropriate marginal plots using
<code>plot</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Examine the marginal effects of the first two variables - gaussian example</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># Shows the fitted model predictions as a function of 1st two predictors</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># with all the others integrated out</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">plot</span>(gauss_fit_more, <span class="at">var_index =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="additional-useful-functions" class="section level2">
<h2>Additional useful functions</h2>
<p>Finally there are some additional useful functions within the
<code>gbm</code> package to remember. A <code>GBMFit</code> object can
be summarised and printed using <code>summary</code> and
<code>print</code> respectively. Each individually fitted tree can be
“prettified” using <code>pretty_gbm_tree</code> and the loss for a given
distribution can be calculated using the <code>loss</code> S3 method, a
<code>GBMDist</code> object and the appropriate data.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
